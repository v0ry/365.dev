---
tags:
  - type/structure
  - structure/bujo
aliases: 
created: 2025-04-15, 14:00
modified: 2025-04-15T14:01
template-type: BuJo Daily
template-version: "1.3"
---

- How to use `yt-dlp` with cookies for batch downloads
```bash
#!/bin/bash

if [ -z "$1" ]; then
  echo "Usage: $0 <url or batch file>"
  exit 1
fi

INPUT="$1"
TIMESTAMP=$(date +"%Y-%m-%d_%H-%M-%S")
LOGFILE="/home/pi/yt-dlp-logs/download_$TIMESTAMP.log"
ARCHIVE="/home/pi/yt-dlp-logs/downloaded.txt"

# Make sure log directory exists
mkdir -p /home/pi/yt-dlp-logs

CMD=(sudo yt-dlp
  --cookies /home/pi/Documents/Cookies/cookies.txt
  --download-archive "$ARCHIVE"
  -f "bestvideo[width<1280]+bestaudio[language='en']"
  --merge-output-format mp4
  -o "/mnt/sda/%(uploader)s/%(upload_date)s - %(title)s.%(ext)s"
)

# Detect if input is a file or a URL
if [[ -f "$INPUT" ]]; then
  CMD+=(--batch-file "$INPUT")
else
  CMD+=("$INPUT")
fi

# Run the download command, log output
{
  echo "===== Starting Download: $(date) ====="
  echo "Input: $INPUT"
  echo "--------------------------------------"
  "${CMD[@]}"
  RESULT=$?
  echo "===== Download Finished: $(date) ====="
  
  # Beep on success
  if [ "$RESULT" -eq 0 ]; then
    echo -e "\a"  # Terminal bell (works if sound is enabled)
  else
    echo "Download failed. Exit code: $RESULT"
  fi

  exit $RESULT
} | tee "$LOGFILE"
   -f "bestvideo[width<1280]+bestaudio[language='en']"
  20    --merge-output-format mp4
```